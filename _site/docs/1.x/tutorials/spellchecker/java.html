<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="isandlatech">
    
    <title>Getting Started Java | Cohorte Project</title>

    <!-- Fonts -->
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=fr" rel=
    "stylesheet">
    <link href=
    "//fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic,500,500italic,700,700italic"
    rel="stylesheet">

    <!-- Bootstrap Core CSS -->
    <link href="/resources/css/2/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/resources/css/2/cohorte.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body>

<div class="darkstrip"></div>

<div class="darkbluetopbar">
  <div class="container" style="height: 100%">
    <div class="navbar-wrap">
      <div class="container" style="position: relative; height: 100%;">
        <div class="cohorte-logo">
          <a href="/index.html"><img src="/resources/images/cohorte-logo-sm.png" alt="Cohorte logo" /></a>
        </div>
        <nav class="navbar navbar-fixed-top" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img src="/resources/images/cohorte-logo.png"></img></a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
              <li><a href="/docs/1.x/">Documentation</a></li>
		      <li><a href="/downloads/">Downloads</a></li>
		      <li><a href="/community/">Community</a></li>
		      <li><a href="/news">News</a></li>
		      <!--li><a href="/contribute/">Contribute</a></li-->
		      <li>
		        <a href="http://github.com/isandlatech/"><img src="/resources/images/github-logo-black.png" alt="GitHub Logo" /></a>		        
		      </li>  
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

<ul class="nav">          
        
</ul>    
      </div>
    </div>
  </div>
</div>

<div class="midbluebar">
  <div class="container">
    <h1 id="page-title">Getting Started Java</h1>
  </div>
</div>

<div class="page-container">
  <div class="container" style="min-height: 540px;">
    <!-- <div class="row"> -->
      <!-- <div class="span12"> -->
          <div class="main-page-column">
            
            <p><a href="../../../../">Home</a> &gt; <a href="../../">Documentation</a> &gt; <a href="../">Tutorials</a> &gt; <a href="./">Spellchecker</a></p>

<h2 id="cohorte-for-java">COHORTE for Java</h2>

<p>Welcome to COHORTE for Java! With COHORTE, you can build modular and resilient applications using the Java programming language, and take advantage of the many benefits of the COHORTE approach (see <a href="/docs/1.x/what-is-cohorte">what is COHORTE?</a>).</p>

<div class="note">
<span class="note-title">Note</span>
<p class="note-content">
    If you are already familiar with <a href="http://www.osgi.org">OSGi</a>, COHORTE components are a simple <a href="http://felix.apache.org/documentation/subprojects/apache-felix-ipojo.html">Apache Felix iPOJO</a> components. The only thing you should do to be able to run your components in COHORTE is to not instantiate your them manually (using <code>@Instantiate</code> annotation for instance. COHORTE will do it for you and add <a href="/docs/1.x/what-is-cohorte">many features</a> to your final application.
</p>
</div>

<h3 id="spellchecker-application">Spellchecker application</h3>

<p>The application to develop in this tutorial provides a web interface in which users can check the spell of their sentences in one or another language. It concists of three main type of components as shown in the following picture:</p>

<p><img src="spellchecker-app-img2.png" alt="SpellChecker Application" /></p>

<p><br /></p>

<ol>
  <li><strong>Dictionary components</strong>: implementing and providing the <em>Dictionary Service</em>. Each implementation indicates the language of the dictionary as a service property.</li>
  <li><strong>Spell Checker</strong>: implements the <em>Checker Service</em> which take as input a sentence of words, and by using the <em>Dictionary Service</em> it verifies the existance of misspelled words. It uses the adequate provided <em>Dictionary Service</em>s depending on user language choice. A list of missplened words are returned by this service.</li>
  <li><strong>Spell Client</strong>: is a simple web interface that shows a form to the final user to test the application. This component uses the <em>Checker Service</em> for the application’s logic part, and it also requires an <em>HTTP Service</em> to publish the web interface and response to the form requests initiated by the user.</li>
</ol>

<p>The required <em>HTTP Service</em> for the last component <strong>Spell Client</strong> is provided natively by the COHORTE runtime. No need to implement it! In the following, we show you how the different components are implemented in Python or Java programming languages.</p>

<h3 id="setup">Setup</h3>

<p>The first thing we need to do is to set up the development environment. We will be using <a href="http://maven.apache.org">Apache Maven</a>, although you can use whatever build tool you feel confortable using. If you wish to use something else to build this tutorial (such as Ant), you will need to manually account for all the needed dependencies.</p>

<h3 id="spellchecker-java-projects">Spellchecker Java projects</h3>

<p>In order to implement the spellchecker demo application, we decided to decouple it in different bundles (jars) for more modularity and to be able to dynamically update or replace some parts of the application without stopping the system. These bundles are:</p>

<ul>
  <li><code>spellchecker-services</code></li>
  <li><code>spellchecker-en-dictionary</code></li>
  <li><code>spellchecker-fr-dictionary</code></li>
  <li><code>spellchecker-checker</code></li>
  <li><code>spellchecker-client</code></li>
</ul>

<p>In the first bundle <code>spellchecker-services</code> we will put only the Java Interfaces for the <strong>Dictionary Service</strong> and <strong>Checker Service</strong> as explained in the picture above. The Services are supposed to not change over time. The other bundles uses or implements this services to ensure the application’s functionality. </p>

<p>In the following, we will show you how to implement each of this bundles.</p>

<p><br /></p>

<h4 id="spellchecker-services">spellchecker-services</h4>

<p>To create a Maven project, simply type the following command (ensure to have Apache Maven installed). </p>

<pre>
$ <b>cohorte-create-java-project</b> spellchecker spellchecker-services 1.0.0
</pre>

<p>The first argument for the <code>cohorte-create-java-project</code> command is the <strong>groupId</strong> of your Maven project, the second one is the <strong>artifactId</strong>, and the last one is its <strong>version</strong>.</p>

<p>This command will generate an empty Maven project template for a COHORTE project <strong>spellchecker-services</strong> which has the following structure:</p>

<ul>
  <li><code>pom.xml</code>: an XML file that contains information about the project and configuration details used by Maven to build the project. </li>
  <li><code>src/main/java/mypackage/</code>: this folder will contain Java source code of the bundle.</li>
</ul>

<div class="note">
<span class="note-title">Note</span>
<p class="note-content">
Any maven project is identified by it groupId, artifactId, and version number. You find this information in the <code>pom.xml</code> file. Any dependencies to other libraries should be declared also in the <code>pom.xml</code> file. Maven retrieves them automatically when compiling the project.
</p>
</div>

<p>Open eclipse and import this Maven project (ensure that <strong>m2e plugin</strong> is installed on your Eclipse IDE - see <a href="/docs/1.X/ide">this page for more information</a>)</p>

<p><img src="spellchecker-app-img5.png" alt="Eclipse-1" /></p>

<p>Rename the default package <code>mypackage</code> to <code>spellchecker.services</code> and add two interfaces <code>DictionaryService</code> and <code>CheckerService</code>.</p>

<p><img src="spellchecker-app-img6.png" alt="Eclipse-2" /></p>

<p>Update <code>pom.xml</code> file to reflect this new structure. The <code>spellchecker.services</code> package will be exported, so that other bundles can use the interfaces and classes within this package at runtime. </p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml">...
<span class="nt">&lt;Export-Package&gt;</span>
   spellchecker.services
<span class="nt">&lt;/Export-Package&gt;</span>
...</code></pre></div>

<p>Remove the dependency to <code>org.apache.felix.ipojo.annotations</code> as we have no component to be implemented in this bundle. </p>

<p>The two newly created Java interfaces represent service contracts and they have the following methods:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">spellchecker</span><span class="o">.</span><span class="na">services</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DictionaryService</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="nf">check_word</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">);</span>
    <span class="n">String</span> <span class="nf">getLanguage</span><span class="o">();</span>
<span class="o">}</span></code></pre></div>

<p>The <strong>Dictionary Service</strong> takes a word as a string and returns true if it is found in the dictionary. </p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">spellchecker</span><span class="o">.</span><span class="na">services</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CheckerService</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">check</span><span class="o">(</span><span class="n">String</span> <span class="n">paragraph</span><span class="o">,</span> <span class="n">String</span> <span class="n">language</span><span class="o">);</span>
<span class="o">}</span></code></pre></div>

<p>The <strong>Checker Service</strong> takes a paragraph as a string and the language on which we want to check the paragraph and returns the list of missplened words according to the selected language.</p>

<p>Compile this bundle by right-clicking on the <code>pom.xml</code> file, then choose <em>Run As</em> and then <em>Maven install</em>. Or just type the following command at the top level directory of this bundle:</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>mvn clean install</code></pre></div>

<p><br /></p>

<h4 id="spellchecker-en-dictionary">spellchecker-en-dictionary</h4>

<p>To implement the english dictionary provider, you have to follow the same steps as before. You first create a new project template as follow:</p>

<pre>
$ <b>cohorte-create-java-project</b> spellchecker spellchecker-en-dictionary 1.0.0
</pre>

<p>Start by modifying the <code>pom.xml</code> file to include a dependency to <code>spellchecker-services</code> bundle.</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.apache.felix<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>org.apache.felix.ipojo.annotations<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.12.0<span class="nt">&lt;/version&gt;</span>
      <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>spellchecker<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>spellchecker-services<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
  <span class="nt">&lt;/dependencies&gt;</span></code></pre></div>

<p>Rename the default package to <code>spellchecker.dictionaries</code> and add <code>&lt;Private-Package&gt;</code> configuration to your <code>pom.xml</code> file to mention that this package is not exported (and hence not visible for other bundles).</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;Private-Package&gt;</span>
  spellchecker.dictionaries
<span class="nt">&lt;/Private-Package&gt;</span>
<span class="nt">&lt;Import-Package&gt;</span>
  spellchecker.services
<span class="nt">&lt;/Import-Package&gt;</span></code></pre></div>

<p>Ensure to remove the <code>&lt;Export-Package&gt;</code> configuration as no package is exported by this bundle, and to add <code>&lt;Import-Package&gt;</code> configuration to import the <strong>SpellChekcer Services</strong> already bundled.</p>

<p>Finally, creates a new Java class named <code>EnglishDictionary.java</code> in <code>spellchecker.dictionaries</code>package and implements it as follow:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">spellchecker</span><span class="o">.</span><span class="na">dictionaries</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.felix.ipojo.annotations.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">spellchecker.services.DictionaryService</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="nd">@Provides</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnglishDictionary</span> <span class="kd">implements</span> <span class="n">DictionaryService</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">dictionary</span> <span class="o">=</span> 
            <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&quot;hello&quot;</span> <span class="o">,</span> <span class="s">&quot;world&quot;</span><span class="o">,</span> <span class="s">&quot;welcome&quot;</span><span class="o">,</span> <span class="s">&quot;to&quot;</span><span class="o">,</span> <span class="s">&quot;cohorte&quot;</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">check_word</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>        
        <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">trim</span><span class="o">();</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">dictionary</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getlanguage</span><span class="o">()</span> <span class="o">{</span>       
        <span class="k">return</span> <span class="s">&quot;EN&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>This class is an iPOJO component that provides (implements) the <strong>Dictionary Service</strong> and publish it on the service registry with the service property <em>language</em> set to <em>EN</em>. This allow consumer filtering/selecting service providers depending on this published service properties.</p>

<div class="note">
<span class="note-title">Note</span>
<p class="note-content">
Have a look at <a href="http://goo.gl/DJ2XiY" target="_blanc">this page</a> for more information about providing services in iPOJO.
</p>
</div>
<p>Compile this second bundle as you have done for the first one.</p>

<p>Create another bundle project for the <strong>French Dictionary</strong> and change the default implementation to have french words list. Ensure to modify the <em>language</em> service property to be <em>FR</em>. </p>

<p><br /></p>

<h4 id="spellchecker-checker">spellchecker-checker</h4>

<p>This component uses the available <strong>Dictionary Service</strong>s and allows clients to check their paragraphs if they have misspelled words.</p>

<ul>
  <li>Generate a project template for this bundle using the <code>cohorte-create-java-project</code> command:</li>
</ul>

<pre>
$ <b>cohorte-create-java-project</b> spellchecker spellchecker-checker 1.0.0
</pre>

<ul>
  <li>Modify the <code>pom.xml</code> file to include a dependency to <code>spellchecker-services</code> as you have for the previous bundle.</li>
  <li>Rename the default package to <code>spellchecker.checker</code> and add <code>&lt;Private-Package&gt;</code> configuration to your <code>pom.xml</code> file to mention that this package is not exported.</li>
  <li>Remove the <code>&lt;Export-Package&gt;</code> configuration, and add <code>&lt;Import-Package&gt;</code> configuration to import the package containing the <strong>SpellChekcer Services</strong> (interfaces) already bundled (see previous steps).</li>
  <li>Create the <code>Checker.java</code> class and implement it as follow:</li>
</ul>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">spellchecker</span><span class="o">.</span><span class="na">checker</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.felix.ipojo.annotations.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">spellchecker.services.*</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="nd">@Provides</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Checker</span> <span class="kd">implements</span> <span class="n">CheckerService</span> <span class="o">{</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">DictionaryService</span><span class="o">&gt;</span> <span class="n">dictionaries</span> <span class="o">=</span> 
            <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">DictionaryService</span><span class="o">&gt;();</span>
    
    <span class="nd">@Bind</span><span class="o">(</span><span class="n">aggregate</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">bind_dict</span><span class="o">(</span><span class="n">DictionaryService</span> <span class="n">dict</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">dictionaries</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">dict</span><span class="o">.</span><span class="na">getLanguage</span><span class="o">(),</span> <span class="n">dict</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@Unbind</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">unbind_dict</span><span class="o">(</span><span class="n">DictionaryService</span> <span class="n">dict</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">dictionaries</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">dict</span><span class="o">.</span><span class="na">getLanguage</span><span class="o">());</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">synchronized</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">check</span><span class="o">(</span><span class="n">String</span> <span class="n">paragraph</span><span class="o">,</span> <span class="n">String</span> <span class="n">language</span><span class="o">)</span> <span class="o">{</span>         
        <span class="n">String</span><span class="o">[]</span> <span class="n">checked_words</span> <span class="o">=</span> <span class="n">paragraph</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">);</span>
        <span class="n">DictionaryService</span> <span class="n">dict</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">dictionaries</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">language</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dict</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">checked_words</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">dict</span><span class="o">.</span><span class="na">check_word</span><span class="o">(</span><span class="n">checked_words</span><span class="o">[</span><span class="n">i</span><span class="o">])</span> <span class="o">==</span> <span class="kc">false</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">checked_words</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>Each time a <strong>Dictionary Service</strong> is deployed at runtime, this component is notified via the <code>@Bind</code> annotation. In our case, we save all the dictionaries in an internal map for use in the <code>check</code> method.</p>

<p><br /></p>

<h4 id="spellchecker-client">spellchecker-client</h4>

<p>Now its time to implement the last component providing the web interface: <code>spellchecker-client</code>.</p>

<ul>
  <li>Generate a project template for this bundle using the <code>cohorte-create-java-project</code> command:</li>
</ul>

<pre>
$ <b>cohorte-create-java-project</b> spellchecker spellchecker-client 1.0.0
</pre>

<ul>
  <li>Modify the <code>pom.xml</code> file to include a dependency to <code>spellchecker-services</code> as you have done for the previous bundles.</li>
  <li>Rename the default package to <code>spellchecker.client</code> and add <code>&lt;Private-Package&gt;</code> configuration to your <code>pom.xml</code> file to mention that this package is not exported.</li>
  <li>Remove the <code>&lt;Export-Package&gt;</code> configuration, and add <code>&lt;Import-Package&gt;</code> configuration to import the package containing the <strong>SpellChekcer Services</strong> (interfaces) already bundled (see previous steps).</li>
  <li>Create the <code>SpellChecker.java</code> class and implement it as follow:</li>
</ul>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">spellchecker</span><span class="o">.</span><span class="na">client</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.felix.ipojo.annotations.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.service.http.HttpService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">spellchecker.services.CheckerService</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpellChecker</span> <span class="kd">extends</span> <span class="n">HttpServlet</span> <span class="o">{</span>

    <span class="nd">@Requires</span>
    <span class="n">CheckerService</span> <span class="n">checker</span><span class="o">;</span>
    
    <span class="nd">@Requires</span>
    <span class="n">HttpService</span> <span class="n">httpService</span><span class="o">;</span>
    
    <span class="nd">@Bind</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">bind_http</span><span class="o">(</span><span class="n">HttpService</span> <span class="n">http</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">httpService</span><span class="o">.</span><span class="na">registerServlet</span><span class="o">(</span><span class="s">&quot;/spellchecker&quot;</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="nd">@Unbind</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">unbind_http</span><span class="o">(</span><span class="n">HttpService</span> <span class="n">http</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">httpService</span><span class="o">.</span><span class="na">unregister</span><span class="o">(</span><span class="s">&quot;/spellchecker&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">paragraph</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;paragraph&quot;</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">language</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;language&quot;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">paragraph</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">language</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;Fill the language and paragraph inputs!&quot;</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">misspelled_words</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">checker</span><span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">paragraph</span><span class="o">,</span> <span class="n">language</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">misspelled_words</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;Dictionary provider for this language is not installed!&quot;</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;&lt;b&gt;The misspelled words are:&lt;/b&gt; &quot;</span><span class="o">;</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;&lt;span style=&#39;color:red;&#39;&gt;&quot;</span><span class="o">;</span>
                <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">word</span> <span class="o">:</span> <span class="n">misspelled_words</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">word</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;&lt;/span&gt;&quot;</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">String</span> <span class="n">html</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;SpellChecker&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;h2&gt;Spellchecker Demo&lt;/h2&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;hr/&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;form action=\&quot;/spellchecker\&quot; method=\&quot;get\&quot; &gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;Language: &lt;input type=\&quot;radio\&quot; name=\&quot;language\&quot; value=\&quot;EN\&quot;&gt;EN&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;input type=\&quot;radio\&quot; name=\&quot;language\&quot; value=\&quot;FR\&quot;&gt;FR&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;input type=\&quot;radio\&quot; name=\&quot;language\&quot; value=\&quot;CN\&quot;&gt;CN&lt;br/&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;Paragraph: &lt;input type=\&quot;text\&quot; name=\&quot;paragraph\&quot; size=\&quot;50\&quot;/&gt;&lt;br/&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;input type=\&quot;submit\&quot; value=\&quot;Check\&quot;/&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;/form&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;hr/&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="n">result</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;hr/&gt;&quot;</span><span class="o">;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="o">;</span>
        
        <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">write</span><span class="o">(</span><span class="s">&quot;Hello World&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    
<span class="o">}</span></code></pre></div>

<h3 id="running-your-application">Running your application</h3>

<p>To start running your awesome first COHORTE application, you need to <a href="../../downloads">download</a> and install the COHORTE runtime platform in your local machine (see the <a href="/documentation/reference-guide/setup.html">setup section of the reference guide</a> for more information). </p>

<p>In the following, we suppose that you have a Max OS X platform. Download the archive file of the COHORTE runtime from the <a href="/downloads">downloads page</a> (e.g., cohorte-1.0.0-macosx.tar.gz).</p>

<p>Extract the dowloaded file anywhere in your file system and create the <em>environment Variable</em> <strong>$COHORTE_HOME</strong> which has as value the fullpath to <code>home</code> sub-folder of the extracted archive file (note that you can just double click on <code>home/setup.command</code> file to setup this environment variable).</p>

<p>The <code>home</code> sub-folder contains the main COHORTE runtime libraries and configuration files. Whereas the <code>base</code> folder contains user-specific bundles and configurations. To run your spellchecker application you need to:</p>

<ul>
  <li>move your spellchecker package folder to <code>base/repo</code> folder.</li>
  <li>fill the <code>base/conf/autorun_conf.js</code> file with the description of application’s components to be instantiated (see more information about <a href="/documentation/reference-guide/applications.html">the formalism in the reference guide</a>).</li>
</ul>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;spellchecker-demo-app&quot;</span><span class="p">,</span>
    <span class="s2">&quot;root&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;spellchecker-java-demo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;components&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * EN Dictionary</span>
<span class="cm">             */</span>
            <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;dictionary_en_java&quot;</span><span class="p">,</span>
            <span class="s2">&quot;factory&quot;</span> <span class="o">:</span> <span class="s2">&quot;spell_dictionary_en_factory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;language&quot;</span> <span class="o">:</span> <span class="s2">&quot;java&quot;</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * FR Dictionary</span>
<span class="cm">             */</span>
            <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;dictionary_fr_java&quot;</span><span class="p">,</span>
            <span class="s2">&quot;factory&quot;</span> <span class="o">:</span> <span class="s2">&quot;spell_dictionary_fr_factory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;language&quot;</span> <span class="o">:</span> <span class="s2">&quot;java&quot;</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * Spell Checker</span>
<span class="cm">             */</span>
            <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;spell_checker_java&quot;</span><span class="p">,</span>
            <span class="s2">&quot;factory&quot;</span> <span class="o">:</span> <span class="s2">&quot;spell_checker_factory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;language&quot;</span> <span class="o">:</span> <span class="s2">&quot;java&quot;</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * Spell Client</span>
<span class="cm">             */</span>
            <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;spell_client_java&quot;</span><span class="p">,</span>
            <span class="s2">&quot;factory&quot;</span> <span class="o">:</span> <span class="s2">&quot;spell_client_factory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;language&quot;</span> <span class="o">:</span> <span class="s2">&quot;java&quot;</span>
        <span class="p">}</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>This description defines a new application named <code>spellchecker-demo-app</code>on which four components will be instantiated. The wiring between the different components is done automatically following the service-oriented architecture (service providers and service consumers) even if one component is placed in remote nodes (see <a href="/documentation/reference-guide/applications.html">COHORTE applications reference guide</a> for more information on how to personalise your application’s architecture). </p>

<p>By default, with this minimal description, all the components will be instantiated in one Python isolate (as all the components are implemented in Python). Recall that a COHORTE Isolate is a seperate process (or a gateway) executing a set of components. The Python Isolate consists in Pelix platform hosting your different bundles as well as the needed system bundles (including the HTTP service provider). </p>

<p>COHORTE runtime components managing your application’s isolates and the distribution of components among them are located on a special purpose (static) isolate (called <code>cohorte-isolate</code>). There is one <code>cohorte-isolate</code>per node, but only one is started as a <strong>Top Isolate</strong> which manage all other isolates.  </p>

<p>Next, you need to launch your application… </p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">./run.sh -t -c</code></pre></div>

<div class="note">
<span class="note-title">NOTE</span>
<p class="note-content">
For more setup and startup configurations, please check <a href="/docs/1.x/startup">this page</a>.
</p>
</div>

<h3 id="test-your-application">Test your application</h3>

<p>The resulting Spell Client looks like this:</p>

<p><img src="spellchecker-app-img3.png" alt="SpellChecker Application" /></p>

<p>The important quality of this architecture is the capability to update any component without restarting the global application. This is important to allow adding new <em>Dictionary Service</em>s or updating a new efficient version of the <strong>Spell Checker</strong> component, without stopping the system and hence guaranting the continuity of business services.</p>

<p>The different application components can be deployed on different Isolates. This is important to ensure that a failure of one or more components does not affect the other ones. The isolation is managed automatically by COHORTE, this feature is explored with more details in <a href="../temper/">this tutorial</a>.</p>

<h3 id="monitoring">Monitoring</h3>

<p><img src="spellchecker-app-img4.png" alt="SpellChecker Application" /></p>

<p><a href="../../../../">Home</a> &gt; <a href="../../">Documentation</a> &gt; <a href="../">Tutorials</a> &gt; <a href="./">Spellchecker</a></p>

            <br/>
            <br/>
            <br/>
            
            <a href="python.html" class="btn float-left" title="Previous page"> Previous </a>
            
            
            <a href="./" class="btn float-right" title="Next page"> Next </a>
            
            <hr/>
            <br/>
            <br/>
                
          </div>
          <div class="sidebar">
            <div class="sidebar-inner">
              <div class="contents">Contents</div>
              <div id="toc"></div>
            </div>
          </div>
          <div style="clear:both"></div>
      <!-- </div> -->
    <!-- </div> -->
  </div>
</div>





<div class="footer">
	<div class="container">
		<ul>
			<li><h5>Documentation</h5></li>
			<li><a href="/documentation/what-is-cohorte.html">What is COHORTE?</a></li>
			<li><a href="/documentation/getting-started.html">Getting Started</a></li>
			<li><a href="/documentation/tutorials.html">Tutorials</a></li>
			<li><a href="/documentation/demonstrations.html">Demonstrations</a></li>
			<li><a href="/documentation/publications.html">Articles & Publications</a></li>
			<li><a href="/documentation/guide.html">Reference Guide</a></li>
		</ul>
		<ul>
			<li><h5>Downloads</h5></li>
			<li><a href="/download/">Stable Release</a></li>
			<li><a href="/download/.html">Development Release</a></li>
		</ul>
		<ul>
			<li><h5>Community</h5></li>
			<li><a href="/community/index.html#mailing_lists">Mailing lists</a></li>
			<li><a href="/community/index.html#github">GitHub</a></li>
		</ul>
		<ul>
			<li><h5>COHORTE</h5></li>
			<li><a href="/blog">Blog</a></li>
			<li><a href="/news">News Archive</a></li>
			<li><a href="/license.html">COHORTE License</a></li>
		</ul>
		</div>
		<div class="container">
		<div class="copyright">
			<a style="float: left; margin-right: 8px;" href="http://isandlatech.com"><img src="/resources/images/isandlatech-logo-sm-carre.png" alt="isandlaTech logo" /></a>
			<p style="float: left;"><br/>Copyright &copy; 2011-<span class="current-year"></span> isandla<i>Tech</i> S.A.R.L<br/>3 chemin du vieux chêne. 38240 Meylan, France</p>
		</div>
		<div class="cohorte-logo-footer">
			<span style="font-size:70%; color:gray;"><a href="http://isandlatech.com">isandla<i>Tech</i></a> is the principal sponsor of </span><img src="/resources/images/cohorte-logo-footer.png" alt="COHORTE footer logo" />
		</div>
	</div> <!-- container -->
</div> <!-- footer -->


    <!-- jQuery -->
    <script src="/resources/js/2/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/resources/js/2/bootstrap.min.js"></script>

    <!-- Script to Activate the Carousel -->
    <script>
    $('.carousel').carousel({
        interval: 5000 //changes the speed
    })
    </script>

	<script src="/resources/js/2/cohorte.js" type="text/javascript"></script>

</body>

</html>

